# python calvin_scene_info.py
# Read and print info in the scene_info.npy, ep_lens.npy, ep_start_end_ids.npy files in each calvin data directory

import os
import numpy as np

for s in ["calvin_debug_dataset/", "task_D_D/", "task_ABC_D/", "task_ABCD_D/"]:
    for t in ["training/", "validation/"]:
        for f in ['scene_info.npy','ep_lens.npy','ep_start_end_ids.npy']:
            p = '/datasets/calvin_new/' + s + t + f
            if os.path.isfile(p):
                print(p)
                print(np.load(p, allow_pickle=True))


# /datasets/calvin_new/calvin_debug_dataset/training/scene_info.npy
# {'calvin_scene_D': [358482, 361252]}
# /datasets/calvin_new/calvin_debug_dataset/training/ep_lens.npy
# 2771
# /datasets/calvin_new/calvin_debug_dataset/training/ep_start_end_ids.npy
# [[358482 361252]]
# /datasets/calvin_new/calvin_debug_dataset/validation/scene_info.npy
# {'calvin_scene_D': [553567, 555241]}
# /datasets/calvin_new/calvin_debug_dataset/validation/ep_lens.npy
# 1675
# /datasets/calvin_new/calvin_debug_dataset/validation/ep_start_end_ids.npy
# [[553567 555241]]
# /datasets/calvin_new/task_D_D/training/scene_info.npy
# {'calvin_scene_D': [0, 611098]}
# /datasets/calvin_new/task_D_D/training/ep_lens.npy
# [19741 18049  8805 22711  1675 23016  9415 22457 30839 11423 26195 12392
#   9118 25377 28434 13812  2771 18374 18785 11839 10809 26207  6574  4812
#  19051 23297 18910  9144 19843 20982 17220]
# /datasets/calvin_new/task_D_D/training/ep_start_end_ids.npy
#  [ 53819  63233]
#  [ 63234  84215]
#  [ 84216 103125]
#  [103126 122176]
#  [122177 147553]
#  [147554 166338]
#  [166339 197177]
#  [197178 219634]
#  [244285 272718]
#  [272719 298925]
#  [298926 308069]
#  [308070 331366]
#  [331367 342789]
#  [342790 349363]
#  [349364 358481]
#  [358482 361252]
#  [361253 370057]
#  [370058 381896]
#  [381897 399945]
#  [420499 438872]
#  [438873 465067]
#  [465068 477459]
#  [477460 497302]
#  [517044 539754]
#  [539755 553566]
#  [553567 555241]
#  [555242 578257]
#  [578258 589066]
#  [589067 593878]
#  [593879 611098]]
# [[497303 517043]
# /datasets/calvin_new/task_D_D/validation/ep_lens.npy
# [37683 24650 16136 20553]
# /datasets/calvin_new/task_D_D/validation/ep_start_end_ids.npy
# [[     0  37682]
#  [219635 244284]
#  [ 37683  53818]
#  [399946 420498]]
# /datasets/calvin_new/task_ABC_D/training/scene_info.npy
# {'calvin_scene_B': [0, 598909], 'calvin_scene_C': [598910, 1191338], 'calvin_scene_A': [1191339, 1795044]}
# /datasets/calvin_new/task_ABC_D/training/ep_lens.npy
# [ 3687  4225  1878 10280  1693  6203  1516  4981  3733  3006  8268  5362
#   3564  2940  5487  6053  1455  5070  5687  9797  1246  1404  6071 10458
#   9591 20885  7628  1794  4275  3975  6606  1286 10254  4124  7611  4778
#   7516  8304  6110  4661  5236  4406  6839  4796 20339  2211   628  4316
#  17179  1954  9533   704 21355 26223  7021 42070  9730 16673 10760 15850
#   5472 44087 31559 33375 23645  6808  2679  5336 21512  3552  1452  9149
#   7635  9449  1178  2510 34896 36236 18211 23230 30650  9778 32172 18630
#   4486   749  7670 10255 27491 24249 41719 28939 26135 11054 16386 17054
#  25330 15142 15643 28389 26162  7378  1648  6559  1045 14662  1232  5711
#   3486 15553  7056  3308 28625 17864  4529 25811  1794   299 14330 10215
#   6309  3015 10358  6380 23881 29617 13306 16446  8417  7548  1610  3718
#   9169 31130 24641 15810 31755 15357 26616 10449 15795 26704  9323 31273
#  28527 15633  9814]
# /datasets/calvin_new/task_ABC_D/training/ep_start_end_ids.npy
# [[      0    3686]
#  [   3687    7911]
#  [   7912    9789]
#  [   9790   20069]
#  [  20070   21762]
#  [  21763   27965]
#  [  27966   29481]
#  [  29482   34462]
#  [  34463   38195]
#  [  38196   41201]
#  [  41202   49469]
#  [  49470   54831]
#  [  54832   58395]
#  [  58396   61335]
#  [  61336   66822]
#  [  66823   72875]
#  [  72876   74330]
#  [  74331   79400]
#  [  79401   85087]
#  [  85088   94884]
#  [  94885   96130]
#  [  96131   97534]
#  [  97535  103605]
#  [ 103606  114063]
#  [ 114064  123654]
#  [ 123655  144539]
#  [ 144540  152167]
#  [ 152168  153961]
#  [ 153962  158236]
#  [ 158237  162211]
#  [ 162212  168817]
#  [ 168818  170103]
#  [ 170104  180357]
#  [ 180358  184481]
#  [ 184482  192092]
#  [ 192093  196870]
#  [ 196871  204386]
#  [ 204387  212690]
#  [ 212691  218800]
#  [ 218801  223461]
#  [ 223462  228697]
#  [ 228698  233103]
#  [ 233104  239942]
#  [ 239943  244738]
#  [ 244739  265077]
#  [ 265078  267288]
#  [ 267289  267916]
#  [ 267917  272232]
#  [ 272233  289411]
#  [ 289412  291365]
#  [ 291366  300898]
#  [ 300899  301602]
#  [ 301603  322957]
#  [ 322958  349180]
#  [ 349181  356201]
#  [ 356202  398271]
#  [ 398272  408001]
#  [ 408002  424674]
#  [ 424675  435434]
#  [ 435435  451284]
#  [ 451285  456756]
#  [ 456757  500843]
#  [ 500844  532402]
#  [ 532403  565777]
#  [ 565778  589422]
#  [ 589423  596230]
#  [ 596231  598909]
#  [ 598910  604245]
#  [ 604246  625757]
#  [ 625758  629309]
#  [ 629310  630761]
#  [ 630762  639910]
#  [ 639911  647545]
#  [ 647546  656994]
#  [ 656995  658172]
#  [ 658173  660682]
#  [ 660683  695578]
#  [ 695579  731814]
#  [ 731815  750025]
#  [ 750026  773255]
#  [ 773256  803905]
#  [ 803906  813683]
#  [ 813684  845855]
#  [ 845856  864485]
#  [ 864486  868971]
#  [ 868972  869720]
#  [ 869721  877390]
#  [ 877391  887645]
#  [ 887646  915136]
#  [ 915137  939385]
#  [ 939386  981104]
#  [ 981105 1010043]
#  [1010044 1036178]
#  [1036179 1047232]
#  [1047233 1063618]
#  [1063619 1080672]
#  [1080673 1106002]
#  [1106003 1121144]
#  [1121145 1136787]
#  [1136788 1165176]
#  [1165177 1191338]
#  [1191339 1198716]
#  [1198717 1200364]
#  [1200365 1206923]
#  [1206924 1207968]
#  [1207969 1222630]
#  [1222631 1223862]
#  [1223863 1229573]
#  [1229574 1233059]
#  [1233060 1248612]
#  [1248613 1255668]
#  [1255669 1258976]
#  [1258977 1287601]
#  [1287602 1305465]
#  [1305466 1309994]
#  [1309995 1335805]
#  [1335806 1337599]
#  [1337600 1337898]
#  [1337899 1352228]
#  [1352229 1362443]
#  [1362444 1368752]
#  [1368753 1371767]
#  [1371768 1382125]
#  [1382126 1388505]
#  [1388506 1412386]
#  [1412387 1442003]
#  [1442004 1455309]
#  [1455310 1471755]
#  [1471756 1480172]
#  [1480173 1487720]
#  [1487721 1489330]
#  [1489331 1493048]
#  [1493049 1502217]
#  [1502218 1533347]
#  [1533348 1557988]
#  [1557989 1573798]
#  [1573799 1605553]
#  [1605554 1620910]
#  [1620911 1647526]
#  [1647527 1657975]
#  [1657976 1673770]
#  [1673771 1700474]
#  [1700475 1709797]
#  [1709798 1741070]
#  [1741071 1769597]
#  [1769598 1785230]
#  [1785231 1795044]]
# /datasets/calvin_new/task_ABC_D/validation/ep_lens.npy
# [37683 24650 16136 20553]
# /datasets/calvin_new/task_ABC_D/validation/ep_start_end_ids.npy
# [[     0  37682]
#  [219635 244284]
#  [ 37683  53818]
#  [399946 420498]]
# /datasets/calvin_new/task_ABCD_D/training/scene_info.npy
# {'calvin_scene_A': [1802438, 2406143], 'calvin_scene_B': [611099, 1210008], 'calvin_scene_C': [1210009, 1802437], 'calvin_scene_D': [0, 611098]}
# /datasets/calvin_new/task_ABCD_D/training/ep_lens.npy
# [ 9415 20982 18910 19051 25377 18785 30839 22457 28434 26207  9144 23297
#  11423  6574  9118  2771  8805 11839 18049 18374 26195 12392 19843 19741
#  22711 13812  1675 23016 10809  4812 17220  3687  4225  1878 10280  1693
#   6203  1516  4981  3733  3006  8268  5362  3564  2940  5487  6053  1455
#   5070  5687  9797  1246  1404  6071 10458  9591 20885  7628  1794  4275
#   3975  6606  1286 10254  4124  7611  4778  7516  8304  6110  4661  5236
#   4406  6839  4796 20339  2211   628  4316 17179  1954  9533   704 21355
#  26223  7021 42070  9730 16673 10760 15850  5472 44087 31559 33375 23645
#   6808  2679  5336 21512  3552  1452  9149  7635  9449  1178  2510 34896
#  36236 18211 23230 30650  9778 32172 18630  4486   749  7670 10255 27491
#  24249 41719 28939 26135 11054 16386 17054 25330 15142 15643 28389 26162
#   7378  1648  6559  1045 14662  1232  5711  3486 15553  7056  3308 28625
#  17864  4529 25811  1794   299 14330 10215  6309  3015 10358  6380 23881
#  29617 13306 16446  8417  7548  1610  3718  9169 31130 24641 15810 31755
#  15357 26616 10449 15795 26704  9323 31273 28527 15633  9814]
# /datasets/calvin_new/task_ABCD_D/training/ep_start_end_ids.npy
# [[  53819   63233]
#  [  63234   84215]
#  [  84216  103125]
#  [ 103126  122176]
#  [ 122177  147553]
#  [ 147554  166338]
#  [ 166339  197177]
#  [ 197178  219634]
#  [ 244285  272718]
#  [ 272719  298925]
#  [ 298926  308069]
#  [ 308070  331366]
#  [ 331367  342789]
#  [ 342790  349363]
#  [ 349364  358481]
#  [ 358482  361252]
#  [ 361253  370057]
#  [ 370058  381896]
#  [ 381897  399945]
#  [ 420499  438872]
#  [ 438873  465067]
#  [ 465068  477459]
#  [ 477460  497302]
#  [ 497303  517043]
#  [ 517044  539754]
#  [ 539755  553566]
#  [ 553567  555241]
#  [ 555242  578257]
#  [ 578258  589066]
#  [ 589067  593878]
#  [ 593879  611098]
#  [ 611099  614785]
#  [ 614786  619010]
#  [ 619011  620888]
#  [ 620889  631168]
#  [ 631169  632861]
#  [ 632862  639064]
#  [ 639065  640580]
#  [ 640581  645561]
#  [ 645562  649294]
#  [ 649295  652300]
#  [ 652301  660568]
#  [ 660569  665930]
#  [ 665931  669494]
#  [ 669495  672434]
#  [ 672435  677921]
#  [ 677922  683974]
#  [ 683975  685429]
#  [ 685430  690499]
#  [ 690500  696186]
#  [ 696187  705983]
#  [ 705984  707229]
#  [ 707230  708633]
#  [ 708634  714704]
#  [ 714705  725162]
#  [ 725163  734753]
#  [ 734754  755638]
#  [ 755639  763266]
#  [ 763267  765060]
#  [ 765061  769335]
#  [ 769336  773310]
#  [ 773311  779916]
#  [ 779917  781202]
#  [ 781203  791456]
#  [ 791457  795580]
#  [ 795581  803191]
#  [ 803192  807969]
#  [ 807970  815485]
#  [ 815486  823789]
#  [ 823790  829899]
#  [ 829900  834560]
#  [ 834561  839796]
#  [ 839797  844202]
#  [ 844203  851041]
#  [ 851042  855837]
#  [ 855838  876176]
#  [ 876177  878387]
#  [ 878388  879015]
#  [ 879016  883331]
#  [ 883332  900510]
#  [ 900511  902464]
#  [ 902465  911997]
#  [ 911998  912701]
#  [ 912702  934056]
#  [ 934057  960279]
#  [ 960280  967300]
#  [ 967301 1009370]
#  [1009371 1019100]
#  [1019101 1035773]
#  [1035774 1046533]
#  [1046534 1062383]
#  [1062384 1067855]
#  [1067856 1111942]
#  [1111943 1143501]
#  [1143502 1176876]
#  [1176877 1200521]
#  [1200522 1207329]
#  [1207330 1210008]
#  [1210009 1215344]
#  [1215345 1236856]
#  [1236857 1240408]
#  [1240409 1241860]
#  [1241861 1251009]
#  [1251010 1258644]
#  [1258645 1268093]
#  [1268094 1269271]
#  [1269272 1271781]
#  [1271782 1306677]
#  [1306678 1342913]
#  [1342914 1361124]
#  [1361125 1384354]
#  [1384355 1415004]
#  [1415005 1424782]
#  [1424783 1456954]
#  [1456955 1475584]
#  [1475585 1480070]
#  [1480071 1480819]
#  [1480820 1488489]
#  [1488490 1498744]
#  [1498745 1526235]
#  [1526236 1550484]
#  [1550485 1592203]
#  [1592204 1621142]
#  [1621143 1647277]
#  [1647278 1658331]
#  [1658332 1674717]
#  [1674718 1691771]
#  [1691772 1717101]
#  [1717102 1732243]
#  [1732244 1747886]
#  [1747887 1776275]
#  [1776276 1802437]
#  [1802438 1809815]
#  [1809816 1811463]
#  [1811464 1818022]
#  [1818023 1819067]
#  [1819068 1833729]
#  [1833730 1834961]
#  [1834962 1840672]
#  [1840673 1844158]
#  [1844159 1859711]
#  [1859712 1866767]
#  [1866768 1870075]
#  [1870076 1898700]
#  [1898701 1916564]
#  [1916565 1921093]
#  [1921094 1946904]
#  [1946905 1948698]
#  [1948699 1948997]
#  [1948998 1963327]
#  [1963328 1973542]
#  [1973543 1979851]
#  [1979852 1982866]
#  [1982867 1993224]
#  [1993225 1999604]
#  [1999605 2023485]
#  [2023486 2053102]
#  [2053103 2066408]
#  [2066409 2082854]
#  [2082855 2091271]
#  [2091272 2098819]
#  [2098820 2100429]
#  [2100430 2104147]
#  [2104148 2113316]
#  [2113317 2144446]
#  [2144447 2169087]
#  [2169088 2184897]
#  [2184898 2216652]
#  [2216653 2232009]
#  [2232010 2258625]
#  [2258626 2269074]
#  [2269075 2284869]
#  [2284870 2311573]
#  [2311574 2320896]
#  [2320897 2352169]
#  [2352170 2380696]
#  [2380697 2396329]
#  [2396330 2406143]]
# /datasets/calvin_new/task_ABCD_D/validation/ep_lens.npy
# [37683 24650 16136 20553]
# /datasets/calvin_new/task_ABCD_D/validation/ep_start_end_ids.npy
# [[     0  37682]
#  [219635 244284]
#  [ 37683  53818]
#  [399946 420498]]
